(window.ppWebpackJsonp=window.ppWebpackJsonp||[]).push([[41],{297:function(e,t,n){"use strict";n.r(t);n(37),n(94),n(238),n(39),n(126),n(78),n(95),n(4),n(5),n(16),n(64),n(51);var i=n(239),o=n.n(i);n(268);function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var a=a||{};function initializeKlpWidget(e,t){try{window.OPPklpWidget=window.klpWidget(e,t.applicationId,t.serviceId,t.appLoginUrl,null,t.currentLang,t.platform,t.options),document.dispatchEvent(new CustomEvent("wepploginwidget_widget_ready"))}catch(e){console.error(e)}}!function(e){a.EventBus=function(t,n){var i=this,o=new e(t,void 0,n),s={},c={},l=a.EventBus.CONNECTING,r=null,d=null;function sendPing(){o.send(JSON.stringify({type:"ping"}))}function sendOrPub(e,t,n,a){checkSpecified("address","string",t),checkSpecified("replyHandler","function",a,!0),checkOpen();var s={type:e,address:t,body:n};if(i.sessionID&&(s.sessionID=i.sessionID),a){var l="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e,t){return t=16*Math.random(),("y"==e?3&t|8:0|t).toString(16)});s.replyAddress=l,c[l]=a}var r=JSON.stringify(s);o.send(r)}function checkOpen(){if(l!=a.EventBus.OPEN)throw new Error("INVALID_STATE_ERR")}function checkSpecified(e,t,n,i){if(!i&&!n)throw new Error("Parameter "+e+" must be specified");if(n&&_typeof(n)!=t)throw new Error("Parameter "+e+" must be of type "+t)}n&&(d=n.vertxbus_ping_interval),d||(d=5e3),i.onopen=null,i.onclose=null,i.login=function(e,t,n){sendOrPub("send","vertx.basicauthmanager.login",{username:e,password:t},function(e){"ok"===e.status&&(i.sessionID=e.sessionID),n&&(delete e.sessionID,n(e))})},i.send=function(e,t,n){sendOrPub("send",e,t,n)},i.publish=function(e,t){sendOrPub("publish",e,t,null)},i.registerHandler=function(e,t){checkSpecified("address","string",e),checkSpecified("handler","function",t),checkOpen();var n=s[e];if(n)n[n.length]=t;else{n=[t],s[e]=n;var i={type:"register",address:e};o.send(JSON.stringify(i))}},i.unregisterHandler=function(e,t){checkSpecified("address","string",e),checkSpecified("handler","function",t),checkOpen();var n=s[e];if(n){var i=n.indexOf(t);if(-1!=i&&n.splice(i,1),0==n.length){var a={type:"unregister",address:e};o.send(JSON.stringify(a)),delete s[e]}}},i.close=function(){checkOpen(),l=a.EventBus.CLOSING,o.close()},i.readyState=function(){return l},o.onopen=function(){sendPing(),r=setInterval(sendPing,d),l=a.EventBus.OPEN,i.onopen&&i.onopen()},o.onclose=function(){l=a.EventBus.CLOSED,r&&clearInterval(r),i.onclose&&i.onclose()},o.onmessage=function(e){var t,n=e.data,o=JSON.parse(n),a=o.body,l=o.replyAddress,r=o.address;l&&(t=function(e,t){i.send(l,e,t)});var d=s[r];if(d)for(var u=d.slice(0),g=0;g<u.length;g++)u[g](a,t);else{var p=c[r];p&&(delete c[r],p(a,t))}}},a.EventBus.CONNECTING=0,a.EventBus.OPEN=1,a.EventBus.CLOSING=2,a.EventBus.CLOSED=3,a.EventBus}(o.a),function(e){window.klpWidget=function(t,n,i,o,s,c,l,r){var d=document.getElementsByTagName("header")[0];new MutationObserver(function(n,i){var o=!0,a=!1,s=void 0;try{for(var c,l=n[Symbol.iterator]();!(o=(c=l.next()).done);o=!0)"class"===c.value.attributeName&&e("header").hasClass("h-fixed-position")&&!e("header").hasClass("h-visible")&&(e(".klp-widget-authenticated-menu").css("display","none"),e("#"+t).removeClass("bubble"))}catch(e){a=!0,s=e}finally{try{o||null==l.return||l.return()}finally{if(a)throw s}}}).observe(d,{attributes:!0,childList:!1,subtree:!1});var u,g="klp-widget-keepalive",p="klp.widget.state",v="klp.widget.document.",h="NCTRL",m="post.ch",f=new RegExp(m+"$"),b=new RegExp(h+"=([^;]+)"),k=void 0,w=void 0,y=!1,x=void 0,C=void 0,S=void 0,L=void 0,A={},P="UNREAD_NOTIFICATIONS",D=!0,I=void 0,O="de",N="",T=(new Date).getTime(),_=0,E={de:{"sign-in":"Login","sign-out":"Logout","change-company":"Firma wählen","change-company-confirm-dialog":'Möchten Sie die aktuelle Firma wechseln? </p></div></div><div class="modal-button-container row"><div class="col-6"></div><div class="col-6 item-centered"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary col-11">Firma wählen</button>',"change-company-support-dialog":'Im Kunden-Supportlogin steht die Funktion "Firma wechseln" nicht zur Verfügung. Führen Sie stattdessen ein Logout durch und starten Sie das Kunden-Supportlogin auf einem neuen Benutzer oder einer neuen Firma. </p></div></div><div class="modal-button-container row"><div class="col-6"></div><div class="col-6 item-centered"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary col-11">Logout</button>',"change-account":"Benutzerkonto wechseln","change-account-confirm-dialog":'Möchten Sie in ein anderes Benutzerkonto wechseln? </p></div></div><div class="modal-button-container row"><div class="col-6"></div><div class="col-6 item-centered"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary col-11">Weiter</button>',"change-account-support-dialog":'Im Kunden-Supportlogin steht die Funktion "Benutzerkonto wechseln" nicht zur Verfügung. Führen Sie stattdessen ein Logout durch und starten Sie das Kunden-Supportlogin auf einem neuen Benutzer oder einer neuen Firma. </p></div></div><div class="modal-button-container row"><div class="col-6"></div><div class="col-6 item-centered"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary col-11">Logout</button>',links:"Meine Onlinedienste",notifications:"Meldungen","toggle-menu":"toggle-menu","no-links":"Keine Favoriten bei Onlinedienste","no-notifications":"Keine ungelesenen Meldungen","more-notifications":"Alle Meldungen","title-text-menu":"Meine Übersicht","title-text-links":"Meine Onlinedienste","title-text-notifications":"Meine Meldungen",userProfile:"Benutzerprofil",settings:"Einstellungen",settingsLink:{d2:"https://int.post.ch/de/kundencenter/einstellungen",ds1:"https://int.post.ch/de/kundencenter/einstellungen",test:"https://int.post.ch/de/kundencenter/einstellungen",int1:"https://int.post.ch/de/kundencenter/einstellungen",int2:"https://int.post.ch/de/kundencenter/einstellungen",prod:"https://www.post.ch/de/kundencenter/einstellungen"}},fr:{"sign-in":"Login","sign-out":"Logout","change-company":"Changer entreprise","change-company-confirm-dialog":'Voulez-vous quitter l\'entreprise actuelle? </p></div></div><div class="modal-button-container row"><div class="col-6"></div><div class="col-6 item-centered"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary col-11">Changer enterprise</button>.',"change-company-support-dialog":'Dans le Login-Support, la fonction changer entreprise n\'est pas disponible. Il faut quitter la session et puis démarrer un nouveau Login-Support avec un autre compte ou une société différente. </p></div></div><div class="modal-button-container row"><div class="col-6"></div><div class="col-6 item-centered"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary col-11">Déconnexion</button>',"change-account":"Changer de compte","change-account-confirm-dialog":'Vous souhaitez changer de compte utilisateur? </p></div></div><div class="modal-button-container row"><div class="col-6"></div><div class="col-6 item-centered"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary col-11">Continuer</button>',"change-account-support-dialog":'La fonction "Changer de compte" n\'est pas disponible dans le login de support client. Déconnectez-vous et démarrez le login de support client sur un autre compte utilisateur ou d\'entreprise. </p></div></div><div class="modal-button-container row"><div class="col-6"></div><div class="col-6 item-centered"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary col-11">Déconnexion</button>',links:"Mes services en ligne",notifications:"notifications","toggle-menu":"toggle-menu","no-links":"Pas de favoris","no-notifications":"Pas de notifications non lues","more-notifications":"Toutes les notifications","title-text-menu":"Mon compte","title-text-links":"Mes services en ligne","title-text-notifications":"Mes notifications",userProfile:"Profil utilisateur",settings:"Paramètres",settingsLink:{d2:"https://int.post.ch/fr/espace-clients/parametres",ds1:"https://int.post.ch/fr/espace-clients/parametres",test:"https://int.post.ch/fr/espace-clients/parametres",int1:"https://int.post.ch/fr/espace-clients/parametres",int2:"https://int.post.ch/fr/espace-clients/parametres",prod:"https://www.post.ch/fr/espace-clients/parametres"}},it:{"sign-in":"Login","sign-out":"Logout","change-company":"Cambia la ditta","change-company-confirm-dialog":'È sicuro di voler uscire dall\'attuale ditta? </p></div></div><div class="modal-button-container row"><div class="col-6"></div><div class="col-6 item-centered"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary col-11">Cambia la ditta</button>',"change-company-support-dialog":'Nell\'Assistenza clienti, il cambiamento di ditta non è disponibile. Bisogna prima eseguire un Logout, quindi avviare nuovamente l\'Assistenza clienti selezionando un utente o una ditta differente. </p></div></div><div class="modal-button-container row"><div class="col-6"></div><div class="col-6 item-centered"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary col-11">Logout</button>',"change-account":"Cambia account utente","change-account-confirm-dialog":'Desidera accedere con un altro account utente? </p></div></div><div class="modal-button-container row"><div class="col-6"></div><div class="col-6 item-centered"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary col-11">Avanti</button>',"change-account-support-dialog":'Nel login assistenza clienti non è disponibile la funzione "Modifica account utente". Si consiglia di effettuare il logout, quindi di riaccedere al login assistenza clienti tramite un nuovo account utente o una nuova ditta. </p></div></div><div class="modal-button-container row"><div class="col-6"></div><div class="col-6 item-centered"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary col-11">Logout</button>',links:"I miei servizi online",notifications:"notifiche","toggle-menu":"toggle-menu","no-links":"Nessun preferito","no-notifications":"Nessuna notifica non letta","more-notifications":"Tutte le notifiche","title-text-menu":"Il mio riepilogo","title-text-links":"I miei servizi online","title-text-notifications":"Le mie notifiche",userProfile:"Profilo utente",settings:"Impostazioni",settingsLink:{d2:"https://int.post.ch/it/centro-clienti/impostazioni",ds1:"https://int.post.ch/it/centro-clienti/impostazioni",test:"https://int.post.ch/it/centro-clienti/impostazioni",int1:"https://int.post.ch/it/centro-clienti/impostazioni",int2:"https://int.post.ch/it/centro-clienti/impostazioni",prod:"https://www.post.ch/it/centro-clienti/impostazioni"}},en:{"sign-in":"Login","sign-out":"Logout","change-company":"Change company","change-company-confirm-dialog":'Would you like to sign-out from the current company? </p></div></div><div class="modal-button-container row"><div class="col-6"></div><div class="col-6 item-centered"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary col-11">Next</button>.',"change-company-support-dialog":'On Kunden-Supportlogin, the function Change company is not available. You have to SignOut and then start again a new Kunden-Supportlogin selecting a different account or company. </p></div></div><div class="modal-button-container row"><div class="col-6"></div><div class="col-6 item-centered"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary col-11">Logout</button>',"change-account":"Change user account","change-account-confirm-dialog":'Do you want to change to another user account? </p></div></div><div class="modal-button-container row"><div class="col-6"></div><div class="col-6 item-centered"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary col-11">Next</button>',"change-account-support-dialog":'The "Change user account" function is not available in the customer support login. Instead, log out and start the customer support login using a new user or new company. </p></div></div><div class="modal-button-container row"><div class="col-6"></div><div class="col-6 item-centered"><button id="klp-widget-authenticated-dochangecompany" class="ppm-button btn btn-primary col-11">Logout</button>',links:"My online services",notifications:"notifications","toggle-menu":"toggle-menu","no-links":"No favorites","no-notifications":"No unread notifications","more-notifications":"All notifications","title-text-menu":"My overview","title-text-links":"My online services","title-text-notifications":"My notifications",userProfile:"User Profile",settings:"Settings",settingsLink:{d2:"https://int.post.ch/en/customer-center/settings",ds1:"https://int.post.ch/en/customer-center/settings",test:"https://int.post.ch/en/customer-center/settings",int1:"https://int.post.ch/en/customer-center/settings",int2:"https://int.post.ch/en/customer-center/settings",prod:"https://www.post.ch/en/customer-center/settings"}}},U={"sign-in":{"access-key":"i","tab-index":0},"sign-out":{"access-key":"o","tab-index":3},"toggle-menu":{"access-key":"m","tab-index":0},"change-company":{"access-key":"c","tab-index":2},"change-account":{"access-key":"c","tab-index":2},notifications:{"access-key":"n","tab-index":1},links:{"access-key":"l","tab-index":4}},M={audit:l.endPoint+"/v1/audit",keepalive:l.endPoint+"/v1/session/keepalive",subscribe:l.endPoint+"/v1/session/subscribe",eventbus:l.endPoint+"/eventbus"},W={logoutTargetURL:"",keepAlive:!0,keepAliveListeningEvents:"click touchstart keydown",keepAliveOnInit:!0,keepAliveInterval:9,showLinks:!0,tabIndex:-1,accessKeys:!1,notificationsNrToLoad:5,debug:!1};void 0!==c&&(O=c.toLowerCase());var z=function(e){return new URL(e)}(logoutURL());if(u=z.origin,-1!==z.hostname.indexOf("account")){var K=z.hostname.split(".")[0];N="account"===K?"prod":K.split("account")[1]}else N="d2";s=[{description:E[O].settings,url:E[O].settingsLink[N],iconclass:"widget_icon_settings"},{description:E[O].userProfile,url:u+"/selfadmin/?lang="+O,iconclass:"widget_icon_profile"}];var R=u+"/selfadmin/messages/?lang="+O;function isHTML5StorageSupported(){try{return"sessionStorage"in window&&null!==window.sessionStorage}catch(e){return log("No local storage available"),!1}}function log(e){W.debug&&window.console&&window.console.log&&console.log("["+function(){var e=new Date;return e.getFullYear()+"-"+e.getMonth()+"1-"+e.getDate()+" "+e.getHours()+":"+e.getMinutes()+":"+e.getSeconds()+","+e.getMilliseconds()}()+"] - KLP.WIDGET - "+e)}function random(){return Math.floor(999999999*Math.random()+1)}function text(e){return E[O][e]}function accessKey(e){return!1===W.accessKeys||null==U[e]["access-key"]?"":'accesskey="'+U[e]["access-key"]+'"'}function tabIndex(e){return W.tabIndex<0?0:U[e]["tab-index"]+W.tabIndex}function join(e,t){return void 0===t?e:-1===e.indexOf("?")?e+"?"+t:e+"&"+t}function loginURL(){return join(o,function(){var t="";return e.each({app:n,service:i,lang:O},function(e,n){-1===o.toLowerCase().indexOf(e.toLowerCase())&&(t.length>0&&(t+="&"),t+=e+"="+n)}),t.length>0?t:void 0}())}function logoutURL(){return join(l.logoutURL,"app="+n+"&lang="+O+"&service=klp&inIframe="+!1+"&logoutTargetURL="+W.logoutTargetURL)}function doLogout(e){log("Clearing cache and sessionData before starting the logout process"),x=void 0,removePersistedState(),log("Proceeding to logoutUrl with following path "+e),window.location.href=e}function setChangeAccountDialog(){e("#"+t+" #klp-widget-authenticated-menu-changecompany").on("click touch",function(n){return n.preventDefault(),e("#"+t+" #klp-widget-authenticated-menu-changecompany").focus(),function(){if(void 0!==x&&x.support){if(isChangeUserAndProfile())var n=text("change-account-support-dialog");else var n=text("change-company-support-dialog");var i=logoutURL()}else{if(isChangeUserAndProfile())var n=text("change-account-confirm-dialog");else var n=text("change-company-confirm-dialog");var i=logoutURL()+"&changecompany=true"}if(0===e("#"+t+" #klp-widget-authenticated-changecompanydialog").length){var o='<div id="changeAccountModal" class="modal"><div class="modal-content"><div class="modal-text-container row"><div class="col-12 text-align-center"><i class="pi pi-2086"></i></div><span class="close">&times;</span><div class="col-1"></div><div class="col-10 text-align-center"><p class="modal-text">'+n+'</div><div class="col-1"></div></div></div>';e("#"+t+" .klp-widget-authenticated").append(o);var a=document.getElementById("changeAccountModal");a.style.display="table";var s=document.getElementsByClassName("close")[0];s.onclick=function(){a.parentElement.removeChild(a)},window.onclick=function(e){e.target==a&&a.parentElement.removeChild(a)},e("#klp-widget-authenticated-dochangecompany").on("click touch",function(n){return n.preventDefault(),e("#"+t+" #klp-widget-authenticated-dochangecompany").focus(),doLogout(i),!1})}}(),!1})}function setUserActive(){D=!0}function restoreState(){var t=function(){if(isHTML5StorageSupported()){var t=sessionStorage.getItem(p);if(t)try{var n=e.parseJSON(t);if(n.ttl>(new Date).getTime()&&function(e){var t=hash(e),n=getControlCookieVal("hash");if(t===n)return!0;if(void 0===n&&!isCurrentLocationPostCh())return log("Cache validated because on a different host=["+window.location.hostname+"] than control cookie domain=["+m+"]"),!0;return log("PersistedData are invalid [hashPersistedData="+t+",control cookie="+n+"]"),!1}(n.sessionData))return log("Valid persisted state loaded: "+t),n;log("Persisted state expired or invalid"),removePersistedState(),setControlCookie("all","sub")}catch(e){log("Persisted state was invalid due to error '"+e+"'"),removePersistedState(),setControlCookie("all","sub")}else log("No persisted state found")}else log("State not loaded because HTML storage not supported");return null}();t&&(w=t.address,y=!0,x=t.sessionData,renderWidget(),isCurrentLocationPostCh()&&renderNotificationsWidget(function(t){var n=v+t;if(isHTML5StorageSupported()){var i=sessionStorage.getItem(n);if(i){var o=e.parseJSON(i);return log("Document "+t+" has been read from cache with value "+o),o}}return null}(P)))}function removePersistedState(){isHTML5StorageSupported()?(sessionStorage.removeItem(p),log("Persisted state removed"),y?(document.cookie=h+"=sub; Path=/; domain="+m,log("Control cookie set to sub")):(document.cookie=h+"=; Path=/; Expires=Wed, 01 Apr 2014 01:00:00 GMT; domain="+m,log("Control cookie removed"))):log("Persisted state not removed because HTML storage not supported")}function isCurrentLocationPostCh(){return window.location.hostname.match(f)}function hash(e){var t,n,i=0;if(0===(e=JSON.stringify(e)).length)return i;for(t=0,n=e.length;t<n;t++)i=(i<<5)-i+e.charCodeAt(t),i|=0;return i}function getControlCookieVal(e){var t=b.exec(document.cookie);if(null!=t){var n=decodeURIComponent(t[1]).split(":");switch(e){case"hash":if(null!=n[0])return n[0];break;case"keepalive":if(null!=n[1])return n[1];break;default:return decodeURIComponent(t[1])}return null}return log("Control cookie not found"),null}function setControlCookie(e,t){switch(e){case"hash":document.cookie=h+"="+t+":"+getControlCookieVal("keepalive")+"; Path=/; domain="+m;break;case"keepalive":document.cookie=h+"="+getControlCookieVal("hash")+":"+t+"; Path=/; domain="+m;break;default:document.cookie=h+"="+t+"; Path=/; domain="+m}}function removeDocumentFromCache(e){var t=v+e;isHTML5StorageSupported()&&(sessionStorage.removeItem(t),log("Document "+e+" has been removed from cache"))}function keepAliveTimerFunction(){D?(D=!1,_keepAliveSessions()):log("Keepalive call canceled due to user inactivity")}function installKeepAliveTimerHandler(){W.keepAlive&&void 0===I&&(W.keepAliveListeningEvents.length>0&&e(document).on(W.keepAliveListeningEvents,setUserActive),I=window.setInterval(keepAliveTimerFunction,60*W.keepAliveInterval*1e3))}function uninstallKeepAliveTimerHandler(){W.keepAlive&&(W.keepAliveListeningEvents.length>0&&e(document).off(W.keepAliveListeningEvents,setUserActive),I&&(window.clearInterval(I),I=void 0))}function _keepAliveSessions(){if(_isUserAuthenticated()){var t="<img src='"+l.keepAliveURL+"/?"+random()+"'><img src='"+M.keepalive+"?"+random()+"'>";e("#"+g).html(t),"function"==typeof S&&S(),setControlCookie("keepalive",(new Date).getTime())}}function renderAuthenticatedWidget(){e("#"+t).off("click touch");var n="",i="";"B2C"===x.userType?i="klp-widget-authenticated-session-name u_var_centered":(n=x.company,i="klp-widget-authenticated-session-name");var o="klp-widget-authenticated";x.support&&(o+=" klp-widget-support"),e("#"+t).html('<div class="'+o+'"><div class="klp-widget-authenticated-session klp-widget-menu-close"><a href="about:blank" role="button" class="klp-widget-authenticated-session-link klp-widget__user" title="'+text("title-text-menu")+'" tabindex="'+tabIndex("toggle-menu")+'" '+accessKey("toggle-menu")+' data-dropdown="klp-widget-authenticated-menu" aria-expanded="false" aria-controls="authenticated-menu"><div class="'+i+'">'+x.name+"&nbsp;"+x.surname+'</div><span class="initials-mobile">'+x.name.substring(0,1)+x.surname.substring(0,1)+'</span><span class="notification-number"></span></a>'+function(t,n){var i="",o="name",a="info";void 0!==s&&(-1!==t.indexOf("centered")&&(o="nameCentered"),0===n.length&&(a="infoHidden"),i+='<li class="name-and-surname"><div class="initials-circle"><div class="initials-container"><div>'+x.name.substring(0,1)+x.surname.substring(0,1)+'</div></div></div><div class="nameAndInfoWrapper"><span class="'+o+'">'+x.name+"&nbsp;"+x.surname+'</span><span class="'+a+'">'+n+'</span></div></li><li><a class="notification-link" title="'+text("title-text-notifications")+'" href="'+R+'"><div class="widget_icon_notification"></div><div class="linkContainer"><span class="klp-widget-notification-link-text">'+text("title-text-notifications")+'</span><span class="notification-number-detail"></span></div></a></li>',e.each(s,function(e,t){i+='<li><a class="notification-link" title="'+t.description+'" href="'+t.url+'"><div class="'+t.iconclass+'"></div><div class="linkContainer"><span class="klp-widget-notification-link-text">'+t.description+"</span></div></a></li>"}));var c="";isOldChangeCompany()?c='<li><a id="klp-widget-authenticated-menu-changecompany" class="notification-link" tabindex="'+tabIndex("change-company")+'" '+accessKey("change-company")+' href="about:blank" role="button" title="'+text("change-company")+'"><div class="widget_icon_changecompany"></div><div class="linkContainer"><span class="klp-widget-notification-link-text">'+text("change-company")+"</span></div></a></li>":isChangeUserAndProfile()&&(c='<li><a id="klp-widget-authenticated-menu-changecompany" class="notification-link" tabindex="'+tabIndex("change-account")+'" '+accessKey("change-company")+' href="about:blank" role="button" title="'+text("change-account")+'"><div class="widget_icon_changecompany"></div><div class="linkContainer"><span class="klp-widget-notification-link-text">'+text("change-account")+"</span></div></a></li>");return'<div class="klp-widget-authenticated-menu" id="authenticated-menu" data-dropdown-toggler="klp-widget__user"><ul>'+i+c+'<li><a id="klp-widget-authenticated-menu-logout" class="notification-link" tabindex="'+tabIndex("sign-out")+'" '+accessKey("sign-out")+' title="'+text("sign-out")+'" href="about:blank" role="button"><div class="widget_icon_logout"></div><div class="linkContainer"><span class="klp-widget-notification-link-text">'+text("sign-out")+"</span></div></a></li></ul></div>"}(i,n)+"</div></div>"),e(".notification-number").css("visibility","hidden"),e(".notification-number-detail").css("visibility","hidden"),function(t,n){e(t).append('<div id="'+n+'" style="display:none;"></div>')}("#"+t,g),e("#"+t+" .klp-widget__user").on("click touch",function(n){return n.preventDefault(),e("#"+t+" .klp-widget__user").focus(),function(n){if(n.is(":visible"))return e("#"+t).removeClass("bubble"),void closeDropdowns();closeDropdowns(),e("."+n.attr("data-dropdown-toggler")).attr("aria-expanded",!0),e("#"+t).addClass("bubble"),n.show(),e(document).on("click",closeDropdowns),n.hasClass("klp-widget-authenticated-menu")&&n.parent().removeClass("klp-widget-menu-close").addClass("klp-widget-menu-open")}(e("#"+t+" .klp-widget-authenticated-menu")),0!==_?_>99?e(".notification-number-detail").css("visibility","visible").text("99+"):e(".notification-number-detail").css("visibility","visible").text(_):e(".notification-number-detail").css("visibility","hidden"),!1}),e("#"+t+" #klp-widget-authenticated-menu-logout").on("click touch",function(n){return n.preventDefault(),e("#"+t+" #klp-widget-authenticated-menu-logout").focus(),doLogout(logoutURL()),!1}),(isOldChangeCompany()||isChangeUserAndProfile())&&setChangeAccountDialog(),e(".klp-widget__user").on("keydown",function(t){if(!(t.which<37||t.which>40)){t.preventDefault();var n=e(this).parent(),i=e("."+e(this).attr("data-dropdown"));switch(t.which){case 37:n.prev().length&&n.prev().find("a").focus(),i.is(":visible")&&e(this).click();break;case 38:i.is(":visible")&&e(this).click();break;case 39:n.next().length&&n.next().find("a").focus(),i.is(":visible")&&e(this).click();break;case 40:i.is(":visible")||e(this).click(),i.find("li:first a").focus()}}}),e(".klp-widget-authenticated-menu").on("keydown","a",function(t){if(!(t.which<37||t.which>40)){t.preventDefault();var n=e(this).parent(),i=e("."+e(this).parents("div").first().attr("data-dropdown-toggler"));switch(t.which){case 37:case 38:n.prev("li").length>0?n.prev("li").find("a").focus():i.click().focus();break;case 39:case 40:n.next("li").length>0&&n.next("li").find("a").focus()}}}),e("body").on("keydown",function(e){27===e.which&&closeDropdowns()})}function isOldChangeCompany(){return"B2B"===x.userType&&x.canChangeCompany&&null==x.changeUserAndProfile||null!=x.changeUserAndProfile&&"profile"===x.changeUserAndProfile}function isChangeUserAndProfile(){return null!=x.changeUserAndProfile&&"userAndProfile"===x.changeUserAndProfile}function showDocument(e,t){switch(t){case P:renderNotificationsWidget(e),function(e,t){var n=v+t;isHTML5StorageSupported()&&(sessionStorage.setItem(n,JSON.stringify(e)),log("Document "+t+" has been persisted on cached with value "+JSON.stringify(e)))}(e,P);break;default:log("Unknown documentType received: "+t)}"function"==typeof A[t]&&A[t](e)}function renderNotificationsWidget(t){null!=t&&e(".notification-number").text()!==t.unreadNotifications&&(0===(_=t.unreadNotifications)?e(".notification-number").css("visibility","hidden"):e(".notification-number").css("visibility","visible"))}function _isUserAuthenticated(){return void 0!==x}function changeLoginURL(e){void 0!==e&&(o=e,renderWidget(),log("Widget appLoginURL has been replaced with "+o))}function login(e,t,n){x=e,renderWidget(),installKeepAliveTimerHandler(),function(e){isHTML5StorageSupported()?(sessionStorage.setItem(p,'{"ttl": '+((new Date).getTime()+e)+',"sessionData": '+JSON.stringify(x)+', "address":"'+w+'"}'),log("State persisted"),setControlCookie("hash",encodeURIComponent(hash(x)))):log("State not persisted because HTML storage not supported")}(t),n&&"function"==typeof C&&(C(),log("loginCallback has been called: "+C))}function logout(){x=void 0,w=void 0,removePersistedState(),removeDocumentFromCache(P),renderWidget(),uninstallKeepAliveTimerHandler(),"function"==typeof L&&L()}function handleMessage(t){switch(log("Message received: "+JSON.stringify(t)),function(t){var n=JSON.stringify({adr:w,evt:t});t.adt?(log("Sending auditing event: "+n),e.ajax({type:"POST",url:M.audit,xhrFields:{withCredentials:!0},crossDomain:!0,data:n})):log("Auditing disabled: "+n)}(t),y=!1,t.typ){case"ukn":t.sub?(y=!0,logout(),subscribe()):logout();break;case"sub":w=t.adr,login(t.data,t.ttl,!1),openCommunication();break;case"hi":login(t.data,t.ttl,!0),removeDocumentFromCache(P);break;case"bye":logout();break;case"doc":showDocument(t.doc,t.doctyp);break;case"rem":!function(e){switch(e){case P:removeDocumentFromCache(P);break;default:log("Unknown documentType received: "+e)}"function"==typeof A[e]&&A[e](void 0)}(t.doctyp);break;default:log("Unknown event received: "+t.typ),logout()}}function subscribe(){if(w)log("Address available, skipping subscription"),openCommunication();else if(isCurrentLocationPostCh()&&null==getControlCookieVal())log("Control cookie not found, skipping subscription"),renderWidget();else{log("Subscribing to get an address");var t=(new Date).getTime();e.ajax({url:M.subscribe,type:"GET",xhrFields:{withCredentials:!0},crossDomain:!0}).done(function(e){handleMessage(e)}).fail(function(e,t){log("Failed to subscribe: "+t),logout(),renderWidget()}),function(e,t){W.debug&&window.console&&window.console.log&&log("Method "+e+" executed on "+t+" ms")}("subscribe()",(new Date).getTime()-t)}}function openCommunication(){k||((k=new a.EventBus(M.eventbus,{debug:W.debug,devel:W.debug})).onopen=function(){log("EventBus opened"),k&&k.registerHandler(w,function(e,t){handleMessage(e)}),e(window).on("beforeunload",closeCommunication)},k.onclose=function(){log("EventBus closed"),log("Communication closed with retrySubscribeOnFail="+y+". Retrying subscribe"),k=null,e(window).off("beforeunload",closeCommunication),y&&(y=!1,w=void 0,subscribe())})}function closeCommunication(){k&&k.close()}function renderWidget(){void 0!==x?renderAuthenticatedWidget():(e("#"+t).addClass("anonymous"),e("#"+t).html('<div class="klp-widget-anonymous"><div class="klp-widget-anonymous__wrapper"><a tabindex="'+tabIndex("sign-in")+'" '+accessKey("sign-in")+' title="'+text("sign-in")+'" href="'+loginURL()+'"><span class="klp-widget-anonymous__text">'+text("sign-in")+'</span><svg class="ppm-svg-icon ppm-main-navigation__login-icon" focusable="false"><use xlink:href="#2064_arrow-enter"></use></svg></a></div></div>'),e("#"+t).on("click touch",function(e){return e.preventDefault(),document.location.href=loginURL(),!1})),T&&(log("Widget shows up in "+((new Date).getTime()-T)+" [msec]"),T=void 0),e(".klp-widget-authenticated-session-link").click()}function closeDropdowns(n){null!=n&&e(n.target).parents("#"+t).length>0||(e(document).off("click",closeDropdowns),e("#"+t).removeClass("bubble"),e("#"+t+" .klp-widget-authenticated-menu").hide().parent().removeClass("klp-widget-menu-open").addClass("klp-widget-menu-close"),e("."+e("#"+t+" .klp-widget-authenticated-menu").attr("data-dropdown-toggler")).attr("aria-expanded",!1))}return void 0!==r&&(W=e.extend(W,r)),restoreState(),subscribe(),W.keepAliveOnInit&&_isUserAuthenticated()&&function(){var e=(new Date).getTime(),t=getControlCookieVal("keepalive");if(isNaN(t)||e-parseInt(t)>60*W.keepAliveInterval*1e3)return log("Running keepAliveSessionsOnInit"),void _keepAliveSessions();log("keepAliveSessionsOnInit not running due to [now="+e+",last="+t+",interval="+60*W.keepAliveInterval*1e3)}(),function(){function receiveMessage(e){"syncWidget"===e.data&&(log("PostMessage syncWidget received"),subscribe())}log("Preparing for communication with iframe content"),window.addEventListener?window.addEventListener("message",receiveMessage):window.attachEvent("onmessage",receiveMessage)}(),{keepAliveSessions:function(){_keepAliveSessions()},isUserAuthenticated:function(){return _isUserAuthenticated()},getUserType:function(){return _isUserAuthenticated()?x.userType:"NONE"},getCurrentAuthLevel:function(){return _isUserAuthenticated()?x.authLevel:"NONE"},changeAppLoginURL:function(e){changeLoginURL(e)},updateWidget:function(t){!function(t){void 0!==t&&(W=e.extend(W,t),renderWidget()),log("Widget has been updated")}(t)},registerLoginCallback:function(e){log("Login callback has been registered"),C=e},unregisterLoginCallback:function(){log("Login callback has been un-registered"),C=void 0},registerKeepAliveCallback:function(e){log("KeepAlive callback has been registered"),S=e},unregisterKeepAliveCallback:function(){log("KeepAlive callback has been un-registered"),S=void 0},registerLogoutCallback:function(e){log("Logout callback has been registered"),L=e},unregisterLogoutCallback:function(){log("Logout callback has been un-registered"),L=void 0},registerDocumentCallback:function(e,t){log("Document callback for documentType "+e+" has been registered"),A[e]=t},unregisterDocumentCallback:function(e){log("Document callback for documentType "+e+" has been un-registered"),A[e]=void 0},registerShowLinksCallback:function(e){log("Show links callback has been registered"),e},unregisterShowLinksCallback:function(){log("Show links callback has been un-registered"),void 0},version:function(){return"${project.version}"},setDebug:function(e){W.debug=e}}}}(jQuery),n.d(t,"initializeKlpWidget",function(){return initializeKlpWidget}),window.POSTPP&&window.jQuery.noConflict(!0)}}]);